<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  File: README
  
    &mdash; Documentation by YARD 0.9.16
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "README";
  relpath = '';
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="file_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="_index.html">Index</a> &raquo; 
    <span class="title">File: README</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><div id='filecontents'>
<h1 id="label-PDF+Word+Counter">PDF Word Counter</h1>

<p><img src="https://img.shields.io/badge/Nuix-7.6-green.svg"></p>

<p>View the GitHub project <a href="LINK_TO_PROJECT">here</a> or download the
latest release <a href="LINK_TO_PROJECT_RELEASES">here</a>.</p>

<h1 id="label-Overview">Overview</h1>

<p><strong>Written By:</strong> mrk</p>

<p>This script adds custom metadata fields for “Word Count” and “Words Per
Page” to searchable PDFs.</p>

<h1 id="label-Getting+Started">Getting Started</h1>

<h2 id="label-Setup">Setup</h2>

<p>Begin by downloading the latest release of this code. Extract the contents
of the archive into your Nuix scripts directory. In Windows the script
directory is likely going to be either of the following:</p>
<ul><li>
<p><code>%appdata%\Nuix\Scripts</code> - User level script directory</p>
</li><li>
<p><code>%programdata%\Nuix\Scripts</code> - System level script directory</p>
</li></ul>

<h2 id="label-Usage">Usage</h2>

<p>Before running the script you will need to have a case open in Nuix.</p>

<p>The script counts the number of words in an item&#39;s text, and creates
custom metadata fields for “Word Count” and “Words Per Page”.</p>

<h3 id="label-Options">Options</h3>

<p>The script&#39;s options are in count_words.rb and include: -
<code>query:</code> the search query for the items to process. (Default is
searchable PDFs, i.e. <code>mime-type:application/pdf AND
content:*&#39;</code>) - <code>handleExcluded:</code> if exclusions should
be considered. (i.e. <code>AND has-exclusion:0</code>) -
<code>recalculate:</code> if custom metadata values should be recalculated
for items that already have the field.</p>

<h3 id="label-Word+Count">Word Count</h3>

<p>The custom metadata for “Word Count” is calculated by taking the item&#39;s
text string, converting non-alphabet characters to space, and splitting on
whitespace (i.e. <code>String.gsub(/[^-a-zA-Z]/, &#39;
&#39;).split.size</code>). This works because <code>string.split</code>
splits on whitespace with leading whitespace and runs of contiguous
whitespace characters ignored.</p>

<p>Search Examples: - Less than 20 words:
<code>integer-custom-metadata-exact:&quot;Word Count&quot;:[0 TO 20}</code>
- Between 20 and 40 words: <code>integer-custom-metadata-exact:&quot;Word
Count&quot;:[20 TO 40]</code> - Over 100 words:
<code>integer-custom-metadata-exact:&quot;Word Count&quot;:{100 TO
*]</code></p>

<h3 id="label-Words+Per+Page">Words Per Page</h3>

<p>The custom metadata for “Words Per Page” is a float, dividing the word
count by the number of pages. The number of pages is determined by the
metadata property “Page Count” (or 1 if the property is nil).</p>

<p>Search Examples: - Less than 1 word per page:
<code>float-custom-metadata-exact:&quot;Words Per Page&quot;:[0 TO
1}</code> - At least 5.5 words per page:
<code>float-custom-metadata-exact:&quot;Words Per Page&quot;:[5.5 TO
*]</code></p>

<h2 id="label-Cloning+this+Repository">Cloning this Repository</h2>

<p>This script relies on code from <a href="https://github.com/Nuix/Nx">Nx</a>
to present a settings dialog and progress dialog. This JAR file is not
included in the repository (although it is included in release downloads).
If you clone this repository, you will also want to obtain a copy of Nx.jar
by either: 1. Building it from <a href="https://github.com/Nuix/Nx">the
source</a> 2. Downloading an already built JAR file from the <a
href="https://github.com/Nuix/Nx/releases">Nx releases</a></p>

<p>Once you have a copy of Nx.jar, make sure to include it in the same
directory as the scripts.</p>

<h1 id="label-License">License</h1>

<pre class="code ruby"><code class="ruby">Copyright 2018 Nuix

Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.</code></pre>
</div></div>

      <div id="footer">
  Generated on Thu Nov  8 12:28:43 2018 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.16 (ruby-2.3.3).
</div>

    </div>
  </body>
</html>